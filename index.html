<!DOCTYPE html>
<html>
<head>
    <title>Juego de la Serpiente</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #game-board {
            width: 300px;
            height: 300px;
            border: 1px solid black;
            display: grid;
            grid-template-columns: repeat(20, 1fr);
        }

        .cell {
            background-color: #f2f2f2;
            border: 1px solid #e0e0e0;
        }

        .cell.snake {
            background-color: green;
        }

        .cell.food {
            background-color: red;
        }
    </style>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            const gameBoard = document.getElementById('game-board');
            const gridSize = 20;
            const cells = [];

            let snake = [{ x: 10, y: 10 }];
            let food = { x: 5, y: 5 };
            let direction = 'right';
            let intervalId;

            function createGameBoard() {
                for (let row = 0; row < gridSize; row++) {
                    for (let col = 0; col < gridSize; col++) {
                        const cell = document.createElement('div');
                        cell.classList.add('cell');
                        cells.push(cell);
                        gameBoard.appendChild(cell);
                    }
                }
            }

            function drawSnake() {
                snake.forEach((segment) => {
                    const index = segment.x + segment.y * gridSize;
                    cells[index].classList.add('snake');
                });
            }

            function eraseSnake() {
                snake.forEach((segment) => {
                    const index = segment.x + segment.y * gridSize;
                    cells[index].classList.remove('snake');
                });
            }

            function drawFood() {
                const index = food.x + food.y * gridSize;
                cells[index].classList.add('food');
            }

            function eraseFood() {
                const index = food.x + food.y * gridSize;
                cells[index].classList.remove('food');
            }

            function handleKeydown(event) {
                const key = event.key;
                if (key === 'ArrowUp' && direction !== 'down') {
                    direction = 'up';
                } else if (key === 'ArrowDown' && direction !== 'up') {
                    direction = 'down';
                } else if (key === 'ArrowLeft' && direction !== 'right') {
                    direction = 'left';
                } else if (key === 'ArrowRight' && direction !== 'left') {
                    direction = 'right';
                }
            }

            function handleTouchStart(event) {
                const touch = event.touches[0];
                startX = touch.clientX;
                startY = touch.clientY;
            }

            function handleTouchMove(event) {
                if (!startX || !startY) {
                    return;
                }

                const touch = event.touches[0];
                const deltaX = touch.clientX - startX;
                const deltaY = touch.clientY - startY;

                if (Math.abs(deltaX) > Math.abs(deltaY)) {
                    if (deltaX > 0 && direction !== 'left') {
                        direction = 'right';
                    } else if (deltaX < 0 && direction !== 'right') {
                        direction = 'left';
                    }
                } else {
                    if (deltaY > 0 && direction !== 'up') {
                        direction = 'down';
                    } else if (deltaY < 0 && direction !== 'down') {
                        direction = 'up';
                    }
                }

                startX = null;
                startY = null;
            }

            function moveSnake() {
                const head = { ...snake[0] };

                if (direction === 'up') {
                    head.y--;
                } else if (direction === 'down') {
                    head.y++;
                } else if (direction === 'left') {
                    head.x--;
                } else if (direction === 'right') {
                    head.x++;
                }

                snake.unshift(head);

                const hasEatenFood = head.x === food.x && head.y === food.y;

                if (hasEatenFood) {
                    generateFood();
                } else {
                    snake.pop();
                }
            }

            function generateFood() {
                const newFood = {
                    x: Math.floor(Math.random() * gridSize),
                    y: Math.floor(Math.random() * gridSize)
                };

                const snakeOnFood = snake.some(segment =>
                    segment.x === newFood.x && segment.y === newFood.y
                );

                if (snakeOnFood) {
                    return generateFood();
                }

                food = newFood;
            }

            function gameOver() {
                clearInterval(intervalId);
                alert('Game Over');
            }

            function startGame() {
                createGameBoard();
                drawSnake();
                drawFood();
                intervalId = setInterval(() => {
                    eraseSnake();
                    moveSnake();
                    if (checkCollision()) {
                        gameOver();
                    }
                    drawSnake();
                }, 200);
            }

            function checkCollision() {
                const head = snake[0];
                return (
                    head.x < 0 ||
                    head.x >= gridSize ||
                    head.y < 0 ||
                    head.y >= gridSize ||
                    snake.some((segment, index) => index !== 0 && segment.x === head.x && segment.y === head.y)
                );
            }

            document.addEventListener('keydown', handleKeydown);
            gameBoard.addEventListener('touchstart', handleTouchStart);
            gameBoard.addEventListener('touchmove', handleTouchMove);

            startGame();
        });
    </script>
</head>
<body>
    <div id="game-board"></div>
</body>
</html>
